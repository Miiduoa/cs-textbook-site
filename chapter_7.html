<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chapter 7 — Operating Systems</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .concept-card { background: white; padding: 20px; border-left: 4px solid #f59e0b; margin: 20px 0; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .interactive-box { background: #fff7ed; border: 2px dashed #f59e0b; padding: 20px; border-radius: 8px; margin: 20px 0; }
    .calc-row { display:flex; gap:10px; align-items:center; flex-wrap: wrap; }
    .calc-row input, .calc-row select { padding:6px 8px; border:1px solid #ccc; border-radius:4px; }
    .result-box { margin-top:10px; padding:10px; background:#f8f9fa; border:1px solid #e3e6e8; border-radius:6px; font-family: monospace; }
    table { width:100%; border-collapse: collapse; margin:16px 0; }
    th, td { border:1px solid #e3e6e8; padding:8px; text-align:left; }
    th { background:#fff3cd; }
  </style>
</head>
<body>
  <nav class="toc">
  <details class="toc-details">
    <summary class="toc-toggle">☰ 章節目錄 / Chapters</summary>
    <div class="toc-content">
<h2>CS Textbook</h2>
    <ul>
      <li><a href="index.html">Table of Contents</a></li>
      <li><a href="chapter_0.html">Preface</a></li>
      <li><a href="chapter_1.html">Chapter 1 — Introduction</a></li>
      <li><a href="chapter_2.html">Chapter 2 — Number Systems</a></li>
      <li><a href="chapter_3.html">Chapter 3 — Data Storage</a></li>
      <li><a href="chapter_4.html">Chapter 4 — Operations on Data</a></li>
      <li><a href="chapter_5.html">Chapter 5 — Computer Organization</a></li>
      <li><a href="chapter_6.html">Chapter 6 — Computer Networks</a></li>
      <li><a href="chapter_7.html" class="active">Chapter 7 — Operating Systems</a></li>
      <li><a href="chapter_8.html">Chapter 8 — Algorithms</a></li>
      <li><a href="chapter_9.html">Chapter 9 — Efficiency of Algorithms</a></li>
      <li><a href="chapter_10.html">Chapter 10 — Programming Languages</a></li>
      <li><a href="chapter_11.html">Chapter 11 — Software Engineering</a></li>
      <li><a href="chapter_12.html">Chapter 12 — Data Structure</a></li>
      <li><a href="chapter_13.html">Chapter 13 — Abstract Data Types</a></li>
      <li><a href="chapter_14.html">Chapter 14 — File Structure</a></li>
      <li><a href="chapter_15.html">Chapter 15 — Databases</a></li>
      <li><a href="chapter_16.html">Chapter 16 — Data Compression</a></li>
      <li><a href="chapter_17.html">Chapter 17 — Security</a></li>
      <li><a href="chapter_18.html">Chapter 18 — Theory of Computation</a></li>
      <li><a href="chapter_19.html">Chapter 19 — Computer Graphics</a></li>
      <li><a href="chapter_20.html">Chapter 20 — Artificial Intelligence</a></li>
      <li><a href="chapter_21.html">Chapter 21 — Introduction to Social Media</a></li>
      <li><a href="chapter_22.html">Chapter 22 — Social and Ethical Issues</a></li>
      <li><a href="chapter_23.html">Appendix A — Unicode</a></li>
      <li><a href="chapter_24.html">Appendix B — Unified Modeling Language (UML)</a></li>
      <li><a href="chapter_25.html">Appendix C — Pseudocode</a></li>
      <li><a href="chapter_26.html">Appendix D — Structure Chart</a></li>
      <li><a href="chapter_27.html">Appendix E — Boolean Algebra and Logic Circuits</a></li>
      <li><a href="chapter_28.html">Appendix F — Examples of Programs</a></li>
      <li><a href="chapter_29.html">Appendix G — Mathematical Review</a></li>
      <li><a href="chapter_30.html">Appendix H — Error Detection and Correction</a></li>
      <li><a href="chapter_31.html">Appendix I — Addition/Subtraction (Sign-and-Magnitude)</a></li>
      <li><a href="chapter_32.html">Appendix J — Addition/Subtraction (Reals)</a></li>
    </ul>
    </div>
  </details>
</nav>

  <main>
    <h1>Chapter 7 — Operating Systems</h1>
    <div class="navigation-top" style="display:flex; justify-content:space-between; margin-bottom:20px;">
      <a href="chapter_6.html" class="btn">← Chapter 6</a>
      <a href="chapter_8.html" class="btn">Chapter 8 →</a>
    </div>

    <div class="content-sections">
      <div class="reading-guide">
        <h2>English Reading Guide (中文導讀)</h2>
        <p>作業系統英文常考「名詞＋動作」：<em>schedule, allocate, synchronize, deadlock</em>。讀到四大必要條件時，先把條件背成口訣，再對照題目例子。</p>
        <ul>
          <li><em>Process vs thread</em> 一定要先對照「記憶體是否共享」。</li>
          <li><em>Virtual memory</em> 先抓「page/frame」對映。</li>
          <li><em>Deadlock</em> 題目多半要你畫「資源配置圖」。</li>
        </ul>
      </div>

      <div class="objectives">
        <h2>Learning Objectives</h2>
        <ul>
          <li>Describe core OS responsibilities and services.</li>
          <li>Distinguish processes and threads.</li>
          <li>Compute scheduling metrics (waiting time, turnaround).</li>
          <li>Explain paging and virtual memory basics.</li>
          <li>Identify deadlock conditions and avoidance strategies.</li>
        </ul>
      </div>

      <div class="key-terms">
        <h2>Key Terms</h2>
        <p><span class="key-term">process</span>, <span class="key-term">thread</span>, <span class="key-term">scheduler</span>, <span class="key-term">page</span>, <span class="key-term">frame</span>, <span class="key-term">virtual memory</span>, <span class="key-term">deadlock</span>, <span class="key-term">resource allocation</span></p>
      </div>

      <div class="worked-example">
        <h3>Worked Example: Deadlock Conditions</h3>
        <p>The four necessary conditions are <strong>mutual exclusion</strong>, <strong>hold and wait</strong>, <strong>no preemption</strong>, and <strong>circular wait</strong>. If any one is broken, deadlock cannot occur.</p>
      </div>

      <h2 id="Roles">Roles of an OS</h2>
      <div class="concept-card">
        <p>An operating system (OS) manages hardware and provides services for applications.</p>
        <ul>
          <li><strong>Process management</strong></li>
          <li><strong>Memory management</strong></li>
          <li><strong>File systems</strong></li>
          <li><strong>Device/I-O management</strong></li>
        </ul>
      </div>

      <h2 id="Processes">Processes & Threads</h2>
      <div class="concept-card">
        <p>A <strong>process</strong> is a running program with its own memory. A <strong>thread</strong> is a lightweight execution unit within a process.</p>
        <table>
          <tr><th>Item</th><th>Process</th><th>Thread</th></tr>
          <tr><td>Memory</td><td>Separate address space</td><td>Shared within process</td></tr>
          <tr><td>Creation</td><td>Heavier</td><td>Lighter</td></tr>
        </table>
      </div>

      <h2 id="Scheduling">CPU Scheduling</h2>
      <div class="concept-card">
        <p>Schedulers decide which process runs next. Common algorithms: FCFS, SJF, Round Robin.</p>
      </div>
      <div class="interactive-box">
        <h3>Interactive: Average Waiting Time (FCFS)</h3>
        <div class="calc-row">
          <label>Burst times (comma)</label>
          <input id="burst" value="5,3,8" />
          <button class="btn" onclick="calcWait()">Compute</button>
        </div>
        <div id="waitResult" class="result-box">Avg Wait: 4.0</div>
      </div>

      <h2 id="Memory">Memory & Virtual Memory</h2>
      <div class="concept-card">
        <p>Virtual memory lets processes use more memory than physical RAM by paging to disk.</p>
        <p>Page size is fixed (e.g., 4 KB). Page table maps virtual pages to physical frames.</p>
      </div>
      <div class="interactive-box">
        <h3>Interactive: Pages Needed</h3>
        <div class="calc-row">
          <label>Process Size (MB)</label><input id="procMB" type="number" value="64" />
          <label>Page Size (KB)</label><input id="pageKB" type="number" value="4" />
          <button class="btn" onclick="calcPages()">Compute</button>
        </div>
        <div id="pageResult" class="result-box">Pages: 16384</div>
      </div>

      <h2 id="FileSystems">File Systems</h2>
      <div class="concept-card">
        <p>File systems organize data using directories and metadata (permissions, timestamps, size). Common types: FAT, NTFS, ext4.</p>
      </div>

      <div class="exam-box">
        <h2>Past Exam Questions (Selected)</h2>
        <ol>
          <li>死結四必要條件為何？並以資源 A/B 與 P1/P2 設計避免策略。</li>
          <li>三個行程 A、B、C 持有資源互相等待，請畫資源配置圖並判斷是否死結。</li>
        </ol>
        <p class="exam-source">Sources: <a href="https://master.get.com.tw/exam/Download.ashx?iP=101022&iDP=66897&iS=3086" target="_blank">國立嘉義大學 114 計算機概論</a> · <a href="https://master.get.com.tw/exam/Download.ashx?iP=100896&iDP=66513&iS=3086" target="_blank">國立臺北教育大學 114 計算機概論</a></p>
      </div>

      <h2 id="EndChapter">End-Chapter Materials</h2>
      <ul>
        <li>Why do threads share memory but processes don’t?</li>
        <li>What is the trade-off between FCFS and Round Robin?</li>
        <li>Why is virtual memory useful?</li>
      </ul>

      <h2 id="PracticeSet">Practice Set</h2>
      <ol>
        <li>Compute average waiting time for FCFS with bursts 2, 6, 4.</li>
        <li>A 256 MB process uses 8 KB pages. How many pages?</li>
        <li>Give two responsibilities of an OS.</li>
      </ol>
    </div>
  </main>

  <script>
    function calcWait(){
      const arr = (burst.value||'').split(',').map(s=>parseFloat(s.trim())).filter(n=>!isNaN(n));
      if(arr.length === 0){ waitResult.innerText = 'Avg Wait: n/a'; return; }
      let totalWait = 0; let sum = 0;
      for(let i=0;i<arr.length;i++){
        totalWait += sum;
        sum += arr[i];
      }
      const avg = totalWait / arr.length;
      waitResult.innerText = `Avg Wait: ${avg.toFixed(2)}`;
    }

    function calcPages(){
      const mb = parseFloat(procMB.value||'0');
      const kb = parseFloat(pageKB.value||'1');
      const bytes = mb * 1024 * 1024;
      const pageBytes = kb * 1024;
      const pages = Math.ceil(bytes / pageBytes);
      pageResult.innerText = `Pages: ${pages}`;
    }

    calcWait(); calcPages();
  </script>
</body>
</html>
